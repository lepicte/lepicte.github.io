<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Anonymat avec TOR et Proxychains sous Kali &middot; phackt.com:~#
    
  </title>

  
  <link rel="canonical" href="http://localhost:4000/tor-proxychains">
  

  <link rel="stylesheet" href="http://localhost:4000/public/css/poole.css">
  <link rel="stylesheet" href="http://localhost:4000/public/css/syntax.css">
  <link rel="stylesheet" href="http://localhost:4000/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="http://localhost:4000/public/favicon.ico">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:4000/atom.xml">

  
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox" checked>

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Some infosec stuff.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="http://localhost:4000/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="http://localhost:4000/about">About</a>
        
      
    
      
    
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
    
      
    

    <a class="sidebar-nav-item" href="/archive/v1.1.0.zip">Download</a>
    <a class="sidebar-nav-item" href="">GitHub project</a>
    <span class="sidebar-nav-item">Currently v1.1.0</span>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2020. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">phackt.com:~#</a>
            <small>Let's talk about sec, baby!</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">Anonymat avec TOR et Proxychains sous Kali</h1>
  <span class="post-date">17 Sep 2016</span>
  <p>Bonjour à tous,</p>

<p>Après m’être demandé comment lancer toutes mes commandes derrière un proxy <a href="https://fr.wikipedia.org/wiki/SOCKS">SOCKS</a> pour masquer mon ip (certaines commandes ne proposent pas d’option pour rediriger vers un proxy SOCKS), vous pouvez vous en sortir grâce au réseau <a href="https://fr.wikipedia.org/wiki/Tor_(r%C3%A9seau)">TOR</a> et un outil appelé <a href="https://github.com/haad/proxychains/blob/master/src/proxychains.conf">Proxychains</a>.<br />
<!--more--></p>

<p>Installez tor et proxychains:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt-get install tor
apt-get install proxychains
</code></pre></div></div>

<p>Tor écoute par défaut sur le port <strong>9050</strong>. Editer le fichier <em>/etc/tor/torrc</em> et décommentez la ligne <code class="language-plaintext highlighter-rouge">SOCKSPort 9050</code>.</p>

<p>Lancer ensuite TOR as a service:  <code class="language-plaintext highlighter-rouge">service tor start</code></p>

<p>Vous pouvez vérifier que TOR écoute en lançant la commande <code class="language-plaintext highlighter-rouge">netstat -tulpn</code>, vous devriez voir:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Proto Recv-Q Send-Q Adresse locale          Adresse distante        Etat        PID/Program name
tcp        0      0 127.0.0.1:9050          0.0.0.0:*               LISTEN      -
</code></pre></div></div>

<p><strong>Maintenant comment linker nos commandes sur TOR?</strong></p>

<p>Proxychains va prendre en paramètre notre commande et linker le processus vers le(s) proxy(ies) de votre choix.</p>

<blockquote>
  <p><em>ProxyChains is a UNIX program, that hooks network-related libc functions in dynamically linked programs via a preloaded DLL and redirects the
   connections through SOCKS4a/5 or HTTP proxies.</em></p>
</blockquote>

<p>Utilisation:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ProxyChains-3.1 (http://proxychains.sf.net)
	usage:
		proxychains &lt;prog&gt; [args]
</code></pre></div></div>

<p>Proxychains demande de modifier sa configuration: <code class="language-plaintext highlighter-rouge">gedit /etc/proxychains.conf</code></p>

<p>Voici ma configuration:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># proxychains.conf  VER 3.1
#
#        HTTP, SOCKS4, SOCKS5 tunneling proxifier with DNS.
#	

# The option below identifies how the ProxyList is treated.
# only one option should be uncommented at time,
# otherwise the last appearing option will be accepted
#
dynamic_chain
#
# Dynamic - Each connection will be done via chained proxies
# all proxies chained in the order as they appear in the list
# at least one proxy must be online to play in chain
# (dead proxies are skipped)
# otherwise EINTR is returned to the app
#
#strict_chain
#
# Strict - Each connection will be done via chained proxies
# all proxies chained in the order as they appear in the list
# all proxies must be online to play in chain
# otherwise EINTR is returned to the app
#
#random_chain
#
# Random - Each connection will be done via random proxy
# (or proxy chain, see  chain_len) from the list.
# this option is good to test your IDS :)

# Make sense only if random_chain
#chain_len = 2

# Quiet mode (no output from library)
quiet_mode

# Proxy DNS requests - no leak for DNS data
proxy_dns

# Some timeouts in milliseconds
tcp_read_time_out 15000
tcp_connect_time_out 8000

# ProxyList format
#       type  host  port [user pass]
#       (values separated by 'tab' or 'blank')
#
#
#        Examples:
#
#            	socks5	192.168.67.78	1080	lamer	secret
#		http	192.168.89.3	8080	justu	hidden
#	 	socks4	192.168.1.49	1080
#	        http	192.168.39.93	8080	
#		
#
#       proxy types: http, socks4, socks5
#        ( auth types supported: "basic"-http  "user/pass"-socks )
#
[ProxyList]
# add proxy here ...
# meanwile
# defaults set to "tor"
socks5 	127.0.0.1 9050
</code></pre></div></div>

<p><strong>dynamic_chain</strong>: pertinent surtout si vous chainez plusieurs proxies, les proxies down ne seront simplement pas pris en compte.<br />
<strong>quiet_mode</strong>: sortie non verbeuse.<br />
<strong>proxy_dns</strong>: demandera au proxy d’effectuer les résolutions DNS (SOCKS4a et SOCKS5).<br />
<strong>tcp_read_time_out 15000, tcp_connect_time_out 8000</strong>: socket timeout.<br />
<strong>socks5 127.0.0.1 9050</strong>: ici nous utilisons le réseau TOR.</p>

<p>J’ai eu perso une erreur du type:<br />
<code>ERROR: ld.so: object 'libproxychains.so.3' from LD_PRELOAD cannot be preloaded: ignored.</code></p>

<p>La librairie partagée <em>libproxychains.so.3</em> n’a pas été trouvée. La variable d’environnement <em>LD_PRELOAD</em> n’est donc pas correctement initialisée (variable qui permet d’effectuer le hook des appels aux sockets).</p>

<p>Editez le fichier <em>/usr/bin/proxychains</em> et remplacez<br />
<code class="language-plaintext highlighter-rouge">export LD_PRELOAD=libproxychains.so.3</code><br />
par<br />
<code class="language-plaintext highlighter-rouge">export LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libproxychains.so.3</code>.</p>

<p>Au besoin effectuez un <code class="language-plaintext highlighter-rouge">locate libproxychains.so.3</code>.</p>

<p>Je vous dis à très bientôt!</p>

</div>


<div class="related">
  <h2>Related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/git-secrets-exposed">
            What solutions to prevent git leaks ?
            <small>27 May 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/web-exposed-git-repositories">
            Gathering some information from web exposed git repositories
            <small>05 Aug 2018</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/play-with-permissive-cors">
            Play with permissive CORS
            <small>24 Dec 2017</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>


      </div>
    </div>


    <!-- <label for="sidebar-checkbox" class="sidebar-toggle"></label> -->

    <script src='/public/js/script.js'></script>
 
  </body>
</html>
