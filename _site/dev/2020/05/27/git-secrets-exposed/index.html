<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      What solutions to prevent git leaks ? &middot; Lanyon
    
  </title>

  
  <link rel="canonical" href="http://localhost:4000/dev/2020/05/27/git-secrets-exposed/">
  

  <link rel="stylesheet" href="http://localhost:4000/public/css/poole.css">
  <link rel="stylesheet" href="http://localhost:4000/public/css/syntax.css">
  <link rel="stylesheet" href="http://localhost:4000/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="http://localhost:4000/public/favicon.ico">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:4000/atom.xml">

  
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox" checked>

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>A reserved <a href="https://jekyllrb.com" target="_blank">Jekyll</a> theme that places the utmost gravity on content with a hidden drawer. Made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a>.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="http://localhost:4000/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="http://localhost:4000/about/">About</a>
        
      
    
      
    
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    

    <a class="sidebar-nav-item" href="/archive/v1.1.0.zip">Download</a>
    <a class="sidebar-nav-item" href="">GitHub project</a>
    <span class="sidebar-nav-item">Currently v1.1.0</span>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2020. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Lanyon</a>
            <small>A Jekyll theme</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">What solutions to prevent git leaks ?</h1>
  <span class="post-date">27 May 2020</span>
  <p>Hello,</p>

<p>I will do a quick and dirty post about what’s out there to find / prevent leaks of secrets in your git repositories.<br />
I did not try all of these tools. For the search part, i’m mainly using a fork of Trufflehog with some added features (search in filenames, commits comments, also with custom regexes).</p>

<h1 id="objectives-">Objectives :</h1>

<ul>
  <li>Look into the commits history for sensitive information publicly accessible by an attacker ;</li>
  <li>Prevent secrets leaks ;</li>
  <li>Monitoring and integrating these checks in the Continous Delivery process - aka DevSecOps</li>
</ul>

<h1 id="find-sensitive-data-">Find sensitive data :</h1>

<p><strong>TOOLS :</strong><br />
=&gt; <a href="https://github.com/dxa4481/truffleHog">TRUFFLEHOG</a></p>
<ul>
  <li>Python</li>
  <li>also works for local repo</li>
  <li>strings with high entropy</li>
  <li>custom regex rules</li>
  <li>no search in commits comments or filenames</li>
</ul>

<p>=&gt; <a href="http://michenriksen.com/blog/gitrob-putting-the-open-source-in-osint/">GITROB</a></p>
<ul>
  <li>Go</li>
  <li>Web App</li>
  <li>do not work for local repo AFAIK</li>
</ul>

<p>=&gt; <a href="https://github.com/auth0/repo-supervisor">REPO-SUPERVISOR</a></p>
<ul>
  <li>NodeJS</li>
  <li>generates HTML reports</li>
</ul>

<p>=&gt; <a href="https://github.com/anshumanbh/git-all-secrets">GIT-ALL-SECRETS</a></p>
<ul>
  <li>Go</li>
  <li>using / merging results of <a href="https://github.com/dxa4481/truffleHog">Trufflehog</a> and <a href="https://github.com/dxa4481/truffleHog">Repo-Supervisor</a></li>
</ul>

<p>=&gt; <a href="https://gitlab.com/gitlab-org/security-products/analyzers/secrets">SECRETS ANALYZER</a></p>
<ul>
  <li>Go</li>
  <li>on GITLAB-ORG repo</li>
  <li>using / merging results of <a href="https://github.com/dxa4481/truffleHog">Trufflehog</a> and <a href="https://github.com/zricethezav/gitleaks">Gitleaks</a></li>
</ul>

<p>=&gt; <a href="https://github.com/zricethezav/gitleaks">GITLEAKS</a></p>
<ul>
  <li>Go</li>
  <li>regex and entropy</li>
</ul>

<p>=&gt; <a href="https://github.com/eth0izzle/shhgit">SSHGIT</a></p>
<ul>
  <li>Go</li>
  <li>Web App</li>
  <li>monitoring git repos - Be the first to catch the secret before it gets deleted from git history</li>
  <li><em>shhgit will watch real-time stream and pull out any accidentally committed secrets</em></li>
</ul>

<h1 id="prevent-commits-">Prevent commits :</h1>

<p>What is a Git Hook ? As described <a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks">here</a>:</p>

<p><em>Like many other Version Control Systems, Git has a way to fire off custom scripts when certain important actions occur. There are two groups of these hooks: client-side and server-side. Client-side hooks are triggered by operations such as committing and merging, while server-side hooks run on network operations such as receiving pushed commits. You can use these hooks for all sorts of reasons.</em></p>

<p>Security is a good one.</p>

<p>What kind of hooks can used to prevent leak at an early stage of the git workflow? :</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pre-commit: Used to check if any of the files changed in the commit use prohibited patterns.

commit-msg: Used to determine if a commit message contains a prohibited patterns.

prepare-commit-msg: Used to determine if a merge commit will introduce a history that contains a prohibited pattern at any point. Please note that this hook is only invoked for non fast-forward merges.
</code></pre></div></div>

<p><strong>CLIENT-SIDE HOOKS :</strong></p>

<p>=&gt; <a href="https://github.com/ezekg/git-hound">GITHOUND</a></p>
<ul>
  <li>set githound command into a <em>pre-commit</em> hook</li>
  <li>regexes configured in <code class="language-plaintext highlighter-rouge">.githound.yml</code></li>
</ul>

<p>=&gt; <a href="https://github.com/awslabs/git-secrets">GIT-SECRETS</a></p>
<ul>
  <li>from AWS</li>
  <li>you also can manually scan for secrets before making your repo public: <code class="language-plaintext highlighter-rouge">git secrets --scan-history</code></li>
</ul>

<p><strong>GITHUB ACTIONS :</strong></p>

<p><em><a href="https://help.github.com/en/actions/getting-started-with-github-actions/about-github-actions">GitHub Actions</a> enables you to create custom software development life cycle (SDLC) workflows directly in your GitHub repository.</em></p>

<ul>
  <li><a href="https://github.com/marketplace/actions/gitleaks">Gitleaks Github Action</a></li>
  <li><a href="https://github.com/marketplace/actions/trufflehog-actions-scan">Trufflehog Github Action</a></li>
</ul>

<p><strong>THE GITHUB.COM SCANNING PROJECT :</strong></p>

<p>Github has a project which aims at monitoring leaked third parties tokens from your repositories: <a href="https://help.github.com/en/github/administering-a-repository/about-secret-scanning">https://help.github.com/en/github/administering-a-repository/about-secret-scanning</a>.</p>

<p>Once identified, Github will warn you and will request the provider (from the following list) in an automated way to ask for the immediate revokation of your leaked tokens:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Adafruit
Alibaba Cloud
Amazon Web Services (AWS)
Atlassian
Azure
CloudBees CodeShip
Databricks
Datadog
Discord
Dropbox
Dynatrace
GitHub
GoCardless
Google Cloud
Hashicorp Terraform
Hubspot
Mailgun
npm
NuGet
Palantir
Postman
Proctorio
Pulumi
Samsara
Slack
Stripe
Tencent Cloud
Twilio
</code></pre></div></div>

<h1 id="finally-what-to-conclude-">Finally what to conclude :</h1>

<p>For each leaked secrets linked to an environment which could be targeted by an adversary :</p>
<ul>
  <li>Revoke / update the secret (password, any token / private key, …) as quick as possible ;</li>
  <li><a href="https://help.github.com/en/github/authenticating-to-github/removing-sensitive-data-from-a-repository">Update the git commits history</a></li>
</ul>

<p>More globally :</p>
<ul>
  <li>Warn the stakeholders involved in this data leak (users, providers, …) ;</li>
  <li>Check log files to detect former fraudulent access ;</li>
  <li>Prevent the versioning of sensitive data (via .gitignore and set hooks to monitor your commits) ;</li>
  <li>Include the secret scanning process as part as your continuous delivery process (build factory). For example for Github CI see the Github actions Trufflehog and Gitleaks as aforementioned.</li>
</ul>

<p>See you soon, next posts will be more internal pentesting / windows oriented,<br />
Cheers.</p>

</div>


<div class="related">
  <h2>Related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/web/2018/08/05/web-exposed-git-repositories/">
            Gathering some information from web exposed git repositories
            <small>05 Aug 2018</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/web/2017/12/24/play-with-permissive-cors/">
            Play with permissive CORS
            <small>24 Dec 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/web/2017/07/25/xss-real-life-case-credentials-stealing/">
            A fun case of XSS and other web concepts
            <small>25 Jul 2017</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>


      </div>
    </div>


    <!-- <label for="sidebar-checkbox" class="sidebar-toggle"></label> -->

    <script src='/public/js/script.js'></script>
 
  </body>
</html>
