I"ş$<h3 id="siem-le-monitoring-de-la-sÃ©curitÃ©">SIEM, le monitoring de la sÃ©curitÃ©</h3>

<p>Nous avons vu dans un prÃ©cÃ©dent article quel Ã©tait le contexte rÃ©glementaire de la <a href="http://localhost:4000/introduction-cybersecurite">Loi de Programmation Militaire</a> franÃ§aise.</p>

<p><strong>Que dites-vous dâ€™une petite rÃ©vision ?</strong></p>

<p>La LPM impose aux <strong>OIV</strong> (OpÃ©rateurs dâ€™Importance Vitale) de renforcer la sÃ©curitÃ© des systÃ¨mes dâ€™information critiques quâ€™ils exploitent et de notifier les incidents de sÃ©curitÃ© Ã  lâ€™<a href="http://www.ssi.gouv.fr/">ANSSI</a> (Agence Nationale de la SÃ©curitÃ© des SystÃ¨mes dâ€™Information).<br />
Une premiÃ¨re vague dâ€™arrÃªtÃ©s a Ã©tÃ© publiÃ©e le 1er juillet 2016. Ces arrÃªtÃ©s concernent les secteurs dâ€™activitÃ© des produits de santÃ©, la gestion de lâ€™eau et lâ€™alimentation. Plusieurs autres arrÃªtÃ©s, concernant dâ€™autres secteurs dâ€™activitÃ©, devraient paraÃ®tre dâ€™ici la fin de cette annÃ©e.<br />
<!--more--></p>

<p>Notez que la Commission europÃ©enne a Ã©galement adoptÃ©, en fÃ©vrier 2013, une proposition de directive visant Ã  assurer un niveau Ã©levÃ© commun de sÃ©curitÃ© des rÃ©seaux et de lâ€™information dans lâ€™Union.</p>

<p>Les OIV se retrouvent donc avec lâ€™obligation de mettre en Å“uvre des systÃ¨mes qualifiÃ©s de dÃ©tection des Ã©vÃ¨nements susceptibles dâ€™affecter la sÃ©curitÃ© de leurs systÃ¨mes dâ€™information. En cas de manquement, ceci peut coÃ»ter cher : la LPM 2014-2019 sanctionne les manquements Ã  la loi dâ€™une amende de 150.000â‚¬, sâ€™Ã©levant Ã  750.000â‚¬ pour les personnes morales. La loi franÃ§aise ne distingue pas selon que le manquement est ou non intentionnel. La simple nÃ©gligence est donc en principe condamnable.</p>

<p>Nous voyons donc quâ€™en sus dâ€™un rÃ©el besoin, le cadre rÃ©glementaire concernant la supervision de la sÃ©curitÃ© des entreprises est posÃ©.</p>

<p><strong>Mais en quoi consiste ce monitoring de la sÃ©curitÃ© ?</strong></p>

<p>Nous allons aborder la notion de <strong>SIEM</strong> : Security Information and Event Management.<br />
Le SIEM est le rÃ©sultat de la volontÃ© de superviser lâ€™activitÃ© de son systÃ¨me dâ€™information.<br />
Il a donc pour objectif de collecter les fichiers dâ€™Ã©vÃ¨nements (logs) de diffÃ©rentes sources, de les uniformiser, et de les corrÃ©ler. On parle de corrÃ©lation car ces solutions sont munies de moteurs de corrÃ©lation qui permettent de relier plusieurs Ã©vÃ¨nements Ã  une mÃªme cause.</p>

<p>Un SIEM impliquera Ã©galement la crÃ©ation dâ€™une Ã©quipe dÃ©diÃ©e, capable dâ€™assurer plusieurs niveaux de services autour de lâ€™outil. En effet, il faudra Ãªtre en capacitÃ© de lire, dâ€™analyser, de vÃ©rifier, de valider les alertes de sÃ©curitÃ© remontÃ©es par la solution 7j/7 24H/24, les assaillants nâ€™attendant pas patiemment les heures ouvrÃ©es pour commettre leurs exactions.</p>

<p>En somme, il faudra crÃ©er un SOC (<a href="https://fr.wikipedia.org/wiki/Security_Operations_Center" title="https://fr.wikipedia.org/wiki/Security_Operations_Center">Security Operation Center</a>).</p>

<p><strong>Quel rapport entre journaux et sÃ©curitÃ© ?</strong></p>

<p>Le monitoring du SI implique deux besoins : <strong>la gestion des logs et la supervision de la sÃ©curitÃ©</strong>.</p>

<p><em>La gestion des logs</em>, plus souvent appelÃ©e Â« Log Management Â», consiste en la mise en place dâ€™une ou plusieurs solutions permettant Ã  une entreprise de
collecter, stocker, sÃ©curiser et archiver les journaux dâ€™information provenant des diffÃ©rents Ã©quipements de sÃ©curitÃ©, dâ€™authentification, rÃ©seauxâ€¦</p>

<p>Ce besoin fait trÃ¨s souvent suite Ã  des contraintes lÃ©gales de conservation et de non-rÃ©pudiation des informations. Un exemple est lâ€™analyse post incident et la visualisation de requÃªtes dâ€™exfiltration de donnÃ©es par le hacker. La brique dâ€™indexation et de recherche est assurÃ©e par un systÃ¨me dâ€™indexation trÃ¨s rapide (exemple ElasticSearch en open source).</p>

<p><em>La supervision de la sÃ©curitÃ©</em> quant Ã  elle, relÃ¨ve dâ€™un rÃ©el besoin des entreprises de suivre en temps rÃ©el lâ€™activitÃ© de leur SI, de corrÃ©ler tous les Ã©vÃ¨nements qui sâ€™y passent et dâ€™Ãªtre alertÃ©s en cas de problÃ¨me de sÃ©curitÃ©. Cette partie sera assurÃ©e par une couche <strong>HIDS</strong> (Host Based Intrusion Detection System - ex: OSSEC) / <strong>NIDS</strong> (Network Intrusion Detection System - ex: SNORT). Les alertes de ces systÃ¨mes seront remontÃ©es au SIEM qui effectuera des <strong>corrÃ©lations</strong> (rÃ¨gles de dÃ©tection mises Ã  jours rÃ©guliÃ¨rement, expressions rÃ©guliÃ¨res) permettant de dÃ©tecter des comportements suspicieux probants, et ainsi dâ€™anticiper une attaque (exemple de scan de ports â€“ voir <a href="https://nmap.org/book/man-port-scanning-techniques.html" title="https://nmap.org/book/man-port-scanning-techniques.html">nmap</a>), ou de remonter une alerte sur une attaque en cours.  De surcroÃ®t, les informations remontÃ©es par les NIDS et HIDS sont <strong>complÃ©mentaires</strong> : le NIDS remontera la source de lâ€™attaque (IP) et le payload envoyÃ©, le HIDS alertera sur lâ€™action effectuÃ©e sur le systÃ¨me ciblÃ© et si cette derniÃ¨re a abouti.</p>

<p>Ainsi des rÃ¨gles de corrÃ©lations pourront Ãªtre mises en place pour dÃ©terminer la criticitÃ© dâ€™une alerte (Ã©vitez les rÃ¨gles trop gÃ©nÃ©riques pouvant mener Ã  des faux positifs). Voici un exemple de rÃ¨gle de corrÃ©lation dâ€™un SIEM impliquant des alertes de SNORT et dâ€™OSSEC sur une attaque LFI (<a href="https://www.owasp.org/index.php/Testing_for_Local_File_Inclusion">Local File Inclusion</a>):</p>

<p><img src="http://localhost:4000/public/images/introduction-siem/events_flowchart1.png" alt="CorrÃ©lation LFI" /></p>

<p>Le SIEM dispose dâ€™une partie graphique pour lâ€™affichage des Key Risk Indicators(reportings et dashboards).<br />
Ces composantes sont donc intimement liÃ©es. Les solutions doivent faire appel Ã  des technologies de Big Data pour assurer la rapiditÃ© de traitement et garantir lâ€™intÃ©gritÃ© de ces gros volumes de donnÃ©es qui transitent par le SIEM.</p>

<p><strong>Quelles sont donc ces solutions ?</strong></p>

<p>Selon le Gartner Magic Quadrant 2015 :</p>

<p><img src="http://localhost:4000/public/images/introduction-siem/2015-siem-mq-LG.png" alt="Gartner Magic Quadrant SIEM 2015" /></p>

<p>And the winner isâ€¦. IBM Security QRadar, suivi de HP ArcSight et de Splunk.<br />
Ces solutions sont commerciales, mais le geek qui est en vous se demande dÃ©jÃ  ce quâ€™il en est des solutions libres ? Effectivement il existe des solutions comme <a href="https://www.alienvault.com/products/ossim" title="https://www.alienvault.com/products/ossim">OSSIM</a> qui est un SIEM open source, mais cependant limitÃ© (absence de rÃ¨gles de corrÃ©lations, reporting basique, â€¦).</p>

<p>Il existe Ã©galement une solution dâ€™agrÃ©gation de logs, ou plutÃ´t une stack open source de produits Elastic, la stack <strong>ELK (ElasticSearch, Logstash, Kibana)</strong> :</p>

<ul>
  <li><a href="https://www.elastic.co/fr/products/elasticsearch" title="https://www.elastic.co/fr/products/elasticsearch">ElasticSearch</a> : moteur de stockage et dâ€™indexation de documents et moteur de requÃªte/dâ€™analyse de ceux-ci.</li>
  <li><a href="https://www.elastic.co/products/logstash" title="https://www.elastic.co/products/logstash">Logstash</a>: analyse, filtrage et dÃ©coupage des logs pour les transformer en documents, parfaitement formatÃ©s notamment pour ElasticSearch.</li>
  <li><a href="https://www.elastic.co/products/kibana" title="https://www.elastic.co/products/kibana">Kibana</a>: dashboard interactif et paramÃ©trable permettant de visualiser les donnÃ©es stockÃ©es dans ElasticSearch.</li>
</ul>

<p>Notre premier besoin est couvert, mais concernant notre supervision de la sÃ©curitÃ© ?</p>

<p>Pour notre HIDS, vous trouverez la solution open source <a href="http://ossec.github.io/" title="http://ossec.github.io/">OSSEC</a>. Concernant le NIDS, voici <a href="https://www.snort.org/" title="https://www.snort.org/">SNORT</a>.</p>

<p>Notre prochain article consacrÃ© au SIEM se concentrera donc sur la mise en place de cette solution ELK + surcouche OSSEC. Nous ferons Ã©galement le parallÃ¨le avec les enjeux <a href="http://www.bgfi-groupe.com/" title="http://www.bgfi-groupe.com/">Big Data</a> concernant ces solutions.</p>

<p>A bientÃ´t.
<br />
<br />
RÃ©fÃ©rences:<br />
<a href="http://www.orange-business.com/fr/blogs/securite/securite-organisationnelle-et-humaine/securite-siem-ou-pas-siem-">http://www.orange-business.com/fr/blogs/securite/securite-organisationnelle-et-humaine/securite-siem-ou-pas-siem-</a><br />
<a href="https://www.itrust.fr/SIEM">https://www.itrust.fr/SIEM</a> <br />
<a href="http://www.itrmanager.com/articles/164117/siem-element-incontournable-oiv.html">http://www.itrmanager.com/articles/164117/siem-element-incontournable-oiv.html</a><br />
<a href="http://www.village-justice.com/articles/Quelles-obligations-pour-les-OIV,16739.html">http://www.village-justice.com/articles/Quelles-obligations-pour-les-OIV,16739.html</a><br />
<a href="http://www.wazuh.com/elk-stack/">http://www.wazuh.com/elk-stack/</a><br />
<a href="http://connect.ed-diamond.com/MISC/MISC-069/SIEM-IDS-l-union-fait-elle-la-force">http://connect.ed-diamond.com/MISC/MISC-069/SIEM-IDS-l-union-fait-elle-la-force</a></p>
:ET